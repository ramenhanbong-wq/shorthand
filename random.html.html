<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì†ê¸° ì•½ì–´ ì•”ê¸° ë§ˆìŠ¤í„°</title>
    <style>
        :root {
            --primary-mute: #6c5e7f;    /* í†¤ë‹¤ìš´ëœ ë³´ë¼ */
            --primary-dark: #4a3f58;    /* ê¹Šì€ ë³´ë¼ìƒ‰ ê·¸ë ˆì´ */
            --accent-soft: #9b8bad;     /* ì—°í•œ ë³´ë¼ íšŒìƒ‰ */
            --bg-neutral: #f4f4f7;      /* ì•„ì£¼ ì—°í•œ ë³´ë¼ë¹› íšŒìƒ‰ ë°°ê²½ */
            --white: #ffffff;
            --border-soft: #e2e2e8;
            --error-red: #d63031;
        }

        body {
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            background-color: var(--bg-neutral);
            color: var(--primary-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px; /* ëª¨ë°”ì¼ ì™¸ê³½ ì—¬ë°± */
            box-sizing: border-box;
        }

        .app-container {
            background: var(--white);
            width: 100%; /* ëª¨ë°”ì¼ì—ì„œ ê½‰ ì°¨ê²Œ */
            max-width: 480px; /* PCì—ì„œëŠ” ê¸°ì¡´ í¬ê¸° ìœ ì§€ */
            padding: 40px 30px; /* íŒ¨ë”© ì‚´ì§ ì¡°ì ˆ */
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(108, 94, 127, 0.08);
            box-sizing: border-box;
        }

        .top-label {
            font-size: 12px;
            font-weight: 800;
            color: var(--accent-soft);
            letter-spacing: 3px;
            margin-bottom: 30px;
            text-align: center;
            text-transform: uppercase;
        }

        /* [ì—°ìŠµ ì˜ì—­] ì•½ì–´ í‘œì‹œ */
        .abbr-display {
            font-size: clamp(32px, 10vw, 42px); /* í™”ë©´ í¬ê¸°ì— ë”°ë¼ ê¸€ì í¬ê¸° ìœ ë™ì  ì¡°ì ˆ */
            font-weight: 800;
            color: var(--primary-mute);
            height: 110px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
            border-bottom: 3px solid var(--primary-mute);
            background: linear-gradient(to bottom, transparent, rgba(108, 94, 127, 0.03));
            text-align: center;
        }

        /* [ì—°ìŠµ ì˜ì—­] ì…ë ¥ì°½ */
        input[type="text"] {
            width: 100%;
            padding: 18px 0;
            font-size: 24px;
            border: none;
            border-bottom: 1px solid var(--border-soft);
            text-align: center;
            margin-bottom: 35px;
            outline: none;
            transition: all 0.4s ease;
            background: transparent;
            color: var(--primary-dark);
            border-radius: 0; /* iOS ì…ë ¥ì°½ ë‘¥ê¸€ê²Œ ë°©ì§€ */
        }

        input[type="text"]:focus {
            border-bottom-color: var(--primary-mute);
            border-bottom-width: 2px;
        }

        /* ìƒíƒœ ë°” */
        .status-grid {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 15px;
            background: #fafafc;
            border-radius: 12px;
            font-size: 13px;
            color: var(--primary-mute);
            border: 1px solid var(--border-soft);
        }

        .status-grid b {
            color: var(--primary-dark);
        }

        /* ë©”ë‰´ ë²„íŠ¼ êµ¬ì„± */
        .btn-column {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        button {
            border: 1px solid var(--primary-mute);
            background: transparent;
            color: var(--primary-mute);
            padding: 15px;
            font-size: 14px;
            font-weight: 700;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            -webkit-tap-highlight-color: transparent; /* ëª¨ë°”ì¼ í„°ì¹˜ ì”ìƒ ë°©ì§€ */
        }

        button:hover {
            background: var(--primary-mute);
            color: var(--white);
        }

        .btn-highlight {
            background: var(--primary-mute);
            color: var(--white);
        }

        .btn-ghost {
            border-color: transparent;
            color: #bdc3c7;
            font-weight: 400;
            font-size: 12px;
        }

        #fileInput { display: none; }
        
        .helper-text {
            margin-top: 25px;
            font-size: 11px;
            color: #9ea4ad;
            text-align: center;
            line-height: 1.6;
        }

        /* âœ¨ ëª¨ë°”ì¼ ì‘ì€ í™”ë©´ ëŒ€ì‘ */
        @media (max-width: 380px) {
            .app-container { padding: 30px 20px; }
            .status-grid { font-size: 11px; padding: 10px; }
            button { padding: 12px; font-size: 13px; }
        }
    </style>
</head>
<body>

<div class="app-container">
    <div class="top-label">Shorthand Mastery</div>
    
    <div class="abbr-display" id="abbrDisplay">ì¤€ë¹„ ì™„ë£Œ</div>
    <input type="text" id="userInput" placeholder="ì…ë ¥ í›„ ì—”í„°" autocomplete="off">
    
    <div class="status-grid">
        <span>ì§„í–‰ ì‹œê°„ <b id="timerLabel">0ì´ˆ</b></span>
        <span>í•™ìŠµ í˜„í™© <b id="counterLabel">0 / 0</b></span>
    </div>
    
    <div class="btn-column">
        <button class="btn-highlight" onclick="document.getElementById('fileInput').click()">ğŸ“‚ ì—°ìŠµìš© íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <div class="btn-row">
            <button onclick="downloadResults('ì •ë‹µ')">ì •ë‹µ ì €ì¥</button>
            <button onclick="downloadResults('ì˜¤ë‹µ')">ì˜¤ë‹µ ì €ì¥</button>
        </div>
        <button class="btn-ghost" onclick="resetTest()">ë°ì´í„° ë¦¬ì…‹í•˜ê¸°</button>
        <input type="file" id="fileInput" accept=".txt">
    </div>

    <p class="helper-text">
        ì˜¤íƒ€ê°€ ë°œìƒí•˜ë©´ ìë™ìœ¼ë¡œ 'ì˜¤ë‹µ ëª©ë¡'ì— ì¶”ê°€ë©ë‹ˆë‹¤.<br>
        ëª¨ë“  í…ìŠ¤íŠ¸ íŒŒì¼(.txt)ì„ ë¶ˆëŸ¬ì™€ ì—°ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </p>
</div>

<script>
    let abbreviations = [];
    let totalCount = 0;
    let currentAbbr = "";
    let totalStartTime = null;
    let isFinished = false;
    let hasCurrentError = false;
    let correctList = []; 
    let wrongList = [];   

    document.getElementById('fileInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            abbreviations = e.target.result.split('\n').map(s => s.trim()).filter(s => s !== "");
            totalCount = abbreviations.length;
            resetTest();
        };
        reader.readAsText(file);
    });

    function resetTest() {
        if (totalCount === 0) return;
        totalStartTime = null;
        isFinished = false;
        correctList = [];
        wrongList = [];
        loadNewAbbr();
        updateUI();
    }

    function loadNewAbbr() {
        if (abbreviations.length > 0) {
            currentAbbr = abbreviations[Math.floor(Math.random() * abbreviations.length)];
            document.getElementById('abbrDisplay').innerText = currentAbbr;
            document.getElementById('userInput').value = "";
            document.getElementById('userInput').focus();
            hasCurrentError = false;
        } else {
            isFinished = true;
            document.getElementById('abbrDisplay').innerText = "í•™ìŠµ ì¢…ë£Œ";
            alert("ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤! ì—°ìŠµì´ ëª¨ë‘ ëë‚¬ìŠµë‹ˆë‹¤.");
        }
    }

    document.getElementById('userInput').addEventListener('input', function() {
        if (!totalStartTime) totalStartTime = Date.now();
    });

    document.getElementById('userInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') checkEntry();
    });

    function checkEntry() {
        if (!currentAbbr || isFinished) return;
        const clean = (s) => s.replace(/[^ã„±-ã…ê°€-í£a-zA-Z0-9]/g, "");
        const user = clean(document.getElementById('userInput').value);
        const target = clean(currentAbbr);
        
        let alt = target;
        if (target.startsWith('ì„')) alt = 'ë¥¼' + target.substring(1);
        else if (target.startsWith('ë¥¼')) alt = 'ì„' + target.substring(1);
        else if (target.startsWith('ì™€')) alt = 'ê³¼' + target.substring(1);
        else if (target.startsWith('ê³¼')) alt = 'ì™€' + target.substring(1);

        if (user === target || user === alt) {
            if (!hasCurrentError) correctList.push(currentAbbr);
            abbreviations = abbreviations.filter(a => a !== currentAbbr);
            updateUI();
            loadNewAbbr();
        } else {
            if (!wrongList.includes(currentAbbr)) wrongList.push(currentAbbr);
            hasCurrentError = true;
            document.getElementById('userInput').style.borderBottomColor = "var(--error-red)";
            setTimeout(() => document.getElementById('userInput').style.borderBottomColor = "", 600);
            document.getElementById('userInput').value = "";
        }
    }

    function downloadResults(type) {
        const list = type === 'ì •ë‹µ' ? correctList : wrongList;
        if (list.length === 0) return alert("ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        const blob = new Blob([[...new Set(list)].join('\n')], { type: 'text/plain' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `${type}.txt`;
        a.click();
    }

    setInterval(() => {
        if (totalStartTime && !isFinished) {
            const elapsed = Math.floor((Date.now() - totalStartTime) / 1000);
            document.getElementById('timerLabel').innerText = `${elapsed}ì´ˆ`;
        }
    }, 1000);

    function updateUI() {
        document.getElementById('counterLabel').innerText = `${totalCount - abbreviations.length} / ${totalCount}`;
    }
</script>
</body>
</html>
