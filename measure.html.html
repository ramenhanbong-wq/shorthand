<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘êº¾ë§ˆ Typing Pro - Studio Edition</title>
    <style>
        :root {
            --main-bg: linear-gradient(135deg, #2c3e50 0%, #000000 100%);
            --card-bg: rgba(255, 255, 255, 0.98);
            --stat-card-bg: #f8f9fa;
            --primary-accent: #34495e;
            --text-dark: #2c3e50;
            --text-muted: #7f8c8d;
            --border-color: #dee2e6;
        }

        body {
            font-family: 'Pretendard', -apple-system, sans-serif;
            background: var(--main-bg);
            background-attachment: fixed;
            color: var(--text-dark);
            margin: 0;
            padding: 10px; /* ëª¨ë°”ì¼ ì—¬ë°± */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 1100px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.5);
            padding: 20px; /* ê¸°ë³¸ íŒ¨ë”© ì¤„ì„ */
            position: relative;
            box-sizing: border-box;
        }

        @media (min-width: 768px) {
            .container { padding: 50px; border-radius: 30px; }
        }

        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { font-size: 24px; font-weight: 800; color: var(--primary-accent); margin: 0; }
        .header p { color: var(--text-muted); margin-top: 8px; font-size: 13px; }

        @media (min-width: 768px) {
            .header h1 { font-size: 32px; }
            .header p { font-size: 15px; }
        }

        /* Stats Grid - ë°˜ì‘í˜• (ëª¨ë°”ì¼ 2ì—´, PC 4ì—´) */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        @media (min-width: 768px) {
            .stats-grid { grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        }

        .stat-card {
            background: var(--stat-card-bg);
            padding: 15px 5px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .stat-label { font-size: 10px; font-weight: 700; color: #95a5a6; display: block; margin-bottom: 4px; }
        .stat-value { font-size: 20px; font-weight: 800; color: #2c3e50; }
        
        @media (min-width: 768px) {
            .stat-card { padding: 20px 10px; border-radius: 15px; }
            .stat-label { font-size: 11px; }
            .stat-value { font-size: 26px; }
        }

        /* ìŒì„± ì¬ìƒ ë°” */
        .audio-bar-container {
            background: #f1f3f5;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #seekBar { flex-grow: 1; cursor: pointer; accent-color: var(--primary-accent); }
        .time-info { font-size: 12px; color: var(--text-muted); min-width: 40px; }

        /* ì…ë ¥ ì˜ì—­ */
        textarea {
            width: 100%;
            height: 250px; /* ëª¨ë°”ì¼ì—ì„œëŠ” ì¡°ê¸ˆ ì‘ê²Œ ì‹œì‘ */
            background: #ffffff;
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 15px;
            font-size: 1.1rem;
            line-height: 1.6;
            color: #1a1a1a;
            resize: none;
            outline: none;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        @media (min-width: 768px) {
            textarea { height: 350px; padding: 25px; font-size: 1.3rem; border-radius: 20px; }
        }

        /* ì»¨íŠ¸ë¡¤ ë°” - ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ ì¤„ë°”ê¿ˆ ëŒ€ì‘ */
        .control-bar {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        @media (min-width: 768px) {
            .control-bar { flex-direction: row; justify-content: space-between; align-items: center; margin-top: 30px; }
        }

        .btn-group { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
        
        button {
            padding: 10px 16px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            background: #fff;
            flex: 1; /* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ ë„ˆë¹„ ê· ë“± ë°°ë¶„ */
            min-width: 80px;
        }

        @media (min-width: 768px) {
            button { padding: 12px 22px; border-radius: 10px; font-size: 14px; flex: none; }
        }

        .btn-primary { background: var(--primary-accent); color: white; border: none; }
        .btn-reset { color: #e74c3c; border-color: #fadbd8; flex: none; width: 100%; }
        
        @media (min-width: 768px) {
            .btn-reset { width: auto; }
        }

        /* ê²°ê³¼ì°½ */
        #resultLayer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.98);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            border-radius: 20px;
            padding: 20px;
            box-sizing: border-box;
        }

        .footer { text-align: center; margin-top: 25px; font-size: 11px; color: #bdc3c7; }
        input[type="file"] { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="resultLayer">
        <h2 style="font-size: 24px;">Practice Complete</h2>
        <div id="summaryDisplay" style="font-size: 16px; line-height: 2; text-align: center; margin: 20px 0;"></div>
        <button class="btn-primary" onclick="closeResult()" style="width: 200px;">í™•ì¸</button>
    </div>

    <div class="header">
        <h1>ì¤‘ìš”í•œ ê±´ êº¾ì´ì§€ ì•ŠëŠ” ë§ˆìŒ</h1>
        <p>ESC í‚¤ë¥¼ ëˆ„ë¥´ë©´ ì¸¡ì •ê³¼ ìŒì„±ì´ ì •ì§€ë©ë‹ˆë‹¤.</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-label">TIME</span>
            <span id="timeVal" class="stat-value">0</span><small>s</small>
        </div>
        <div class="stat-card">
            <span class="stat-label">CHARS</span>
            <span id="charVal" class="stat-value">0</span><small>ì</small>
        </div>
        <div class="stat-card">
            <span class="stat-label">SPEED</span>
            <span id="speedVal" class="stat-value">0</span><small>ì/ë¶„</small>
        </div>
        <div class="stat-card">
            <span class="stat-label">AUDIO</span>
            <span id="audioVal" class="stat-value">0</span><small>s</small>
        </div>
    </div>

    <div class="audio-bar-container">
        <span class="time-info" id="currentTime">0:00</span>
        <input type="range" id="seekBar" value="0" step="0.1">
        <span class="time-info" id="totalTime">0:00</span>
    </div>

    <textarea id="typingArea" spellcheck="false" placeholder="ì…ë ¥ì„ ì‹œì‘í•˜ì„¸ìš”..."></textarea>

    <div class="control-bar">
        <div class="btn-group">
            <button onclick="document.getElementById('audioFile').click()">ğŸ“ íŒŒì¼</button>
            <input type="file" id="audioFile" accept="audio/*">
            <button class="btn-primary" onclick="playAudio()">â–¶ ì¬ìƒ</button>
            <button onclick="pauseAudio()">â¸ ì •ì§€</button>
        </div>
        <button class="btn-reset" onclick="resetAll()">ğŸ”„ ë¦¬ì…‹</button>
    </div>
    
    <div class="footer">ë¬´ë‹¨ ë°°í¬ ê¸ˆì§€ | by ê°€ì„</div>
</div>

<audio id="audioPlayer"></audio>

<script>
    // ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ ìœ ì§€
    const typingArea = document.getElementById('typingArea');
    const timeVal = document.getElementById('timeVal');
    const charVal = document.getElementById('charVal');
    const speedVal = document.getElementById('speedVal');
    const audioVal = document.getElementById('audioVal');
    const audioPlayer = document.getElementById('audioPlayer');
    const seekBar = document.getElementById('seekBar');
    const currentTimeText = document.getElementById('currentTime');
    const totalTimeText = document.getElementById('totalTime');
    const resultLayer = document.getElementById('resultLayer');
    const summaryDisplay = document.getElementById('summaryDisplay');

    let startTime = null;
    let timerLoop = null;
    let isStarted = false;

    window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && isStarted) finish();
    });

    function finish() {
        clearInterval(timerLoop);
        typingArea.disabled = true;
        audioPlayer.pause();
        const text = typingArea.value.replace(/[^a-zA-Z0-9ê°€-í£]/g, '');
        const elapsed = (Date.now() - startTime) / 1000;
        const finalSpeed = text.length > 0 ? Math.floor(text.length / (elapsed / 60)) : 0;
        resultLayer.style.display = 'flex';
        summaryDisplay.innerHTML = `ìµœì¢… ì†ë„: <strong>${finalSpeed}</strong> ì/ë¶„<br>ì…ë ¥: ${text.length}ì | ì‹œê°„: ${Math.floor(elapsed)}ì´ˆ`;
    }

    typingArea.addEventListener('input', () => {
        if (!isStarted && typingArea.value.length > 0) {
            isStarted = true;
            startTime = Date.now();
            timerLoop = setInterval(updateAll, 1000);
        }
        updateAll();
    });

    function formatTime(seconds) {
        const min = Math.floor(seconds / 60);
        const sec = Math.floor(seconds % 60);
        return `${min}:${sec < 10 ? '0' : ''}${sec}`;
    }

    function updateAll() {
        if (startTime) {
            const elapsed = (Date.now() - startTime) / 1000;
            timeVal.innerText = Math.floor(elapsed);
            const text = typingArea.value.replace(/[^a-zA-Z0-9ê°€-í£]/g, '');
            charVal.innerText = text.length;
            if (elapsed > 1) speedVal.innerText = Math.floor(text.length / (elapsed / 60));
        }
        if (audioPlayer.duration) {
            seekBar.value = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            currentTimeText.innerText = formatTime(audioPlayer.currentTime);
            audioVal.innerText = Math.max(0, Math.floor(audioPlayer.duration - audioPlayer.currentTime));
        }
    }

    seekBar.addEventListener('input', () => {
        if (audioPlayer.duration) audioPlayer.currentTime = (seekBar.value / 100) * audioPlayer.duration;
    });

    document.getElementById('audioFile').addEventListener('change', function() {
        const file = this.files[0];
        if (file) {
            audioPlayer.src = URL.createObjectURL(file);
            audioPlayer.onloadedmetadata = () => {
                totalTimeText.innerText = formatTime(audioPlayer.duration);
                audioVal.innerText = Math.floor(audioPlayer.duration);
            };
        }
    });

    function playAudio() { if (audioPlayer.src) audioPlayer.play(); }
    function pauseAudio() { audioPlayer.pause(); }
    function resetAll() {
        clearInterval(timerLoop); isStarted = false; startTime = null;
        typingArea.disabled = false; typingArea.value = '';
        timeVal.innerText = '0'; charVal.innerText = '0'; speedVal.innerText = '0';
        resultLayer.style.display = 'none';
    }
    function closeResult() { resultLayer.style.display = 'none'; }
</script>

</body>
</html>