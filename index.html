// 1. 위에서 복사한 구글 앱스 스크립트 URL을 여기에 넣으세요.
const GAS_URL = "여기에_배포된_URL을_붙여넣으세요";

// [보존] 기존 채점 로직 함수 안의 마지막 부분에 아래 내용을 추가합니다.
function analyzeAndGrade() {
    // ... (선생님의 완벽한 LCS 채점 로직 실행 중) ...
    
    let score = n > 0 ? Math.max(0, 100 - ((w + mi + ad) / n * 100)).toFixed(1) : 0;
    
    // [추가된 기능] 구글 시트로 데이터 전송
    saveToGoogleSheet(score, w, mi, ad);
    
    // 화면 결과 표시 로직...
}

// [새로 추가된 서버 통신 함수]
async function saveToGoogleSheet(score, w, mi, ad) {
    const userName = document.getElementById('userName').value || "익명학생";
    const payload = {
        user: userName,
        score: score,
        w: w, mi: mi, ad: ad
    };

    try {
        await fetch(GAS_URL, {
            method: "POST",
            body: JSON.stringify(payload)
        });
        console.log("구글 시트에 기록 저장 완료!");
        loadHistoryFromServer(); // 저장 후 목록 새로고침
    } catch (e) {
        console.error("저장 실패:", e);
    }
}

async function loadHistoryFromServer() {
    try {
        const response = await fetch(GAS_URL);
        const data = await response.json();
        updateHistoryUI(data); // 가져온 데이터로 목록 및 그래프 업데이트
    } catch (e) {
        console.log("기록을 불러올 수 없습니다.");
    }
}
