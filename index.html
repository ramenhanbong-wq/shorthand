<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†ê¸° ë§ˆìŠ¤í„° â€” í†µí•© ëŒ€ì‹œë³´ë“œ</title>
    <style>
        :root {
            --bg: #f5f7fa;
            --surface: #ffffff;
            --primary: #6c5e7f;
            --text: #2d3436;
            --muted: #6b7280;
            --border: #e5e7eb;
        }

        body {
            font-family: 'Pretendard', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* ë¡œê·¸ì¸ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .login-card {
            background: var(--surface);
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.05);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        h1 { color: var(--primary); margin-bottom: 30px; font-weight: 800; }

        input {
            width: 100%;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            box-sizing: border-box;
            outline: none;
            transition: 0.3s;
        }

        input:focus { border-color: var(--primary); }

        button {
            width: 100%;
            padding: 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover { opacity: 0.9; transform: translateY(-2px); }

        /* ëŒ€ì‹œë³´ë“œ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            width: 95%;
            max-width: 1000px;
            margin-top: 20px;
        }

        .menu-item {
            background: var(--surface);
            padding: 30px;
            border-radius: 25px;
            text-decoration: none;
            color: var(--text);
            box-shadow: 0 10px 20px rgba(0,0,0,0.03);
            transition: 0.3s;
            border: 1px solid var(--border);
        }

        .menu-item:hover { transform: translateY(-5px); border-color: var(--primary); }
        .menu-item h3 { margin: 0 0 10px 0; color: var(--primary); }
        .menu-item p { margin: 0; font-size: 0.9rem; color: var(--muted); }

        #dashboard { display: none; flex-direction: column; align-items: center; width: 100%; }
        #login-form { display: block; }
    </style>
</head>
<body>

    <div id="login-form" class="login-card">
        <h1>Welcome</h1>
        <input type="text" id="user-name" placeholder="ì´ë¦„ ì…ë ¥">
        <input type="password" id="user-pw" placeholder="ë¹„ë°€ë²ˆí˜¸">
        <button onclick="handleLogin()">ë¡œê·¸ì¸</button>
    </div>

    <div id="dashboard">
        <h1>ì†ê¸° í•™ìŠµ ëŒ€ì‹œë³´ë“œ</h1>
        <p style="margin-bottom: 30px; color: var(--muted);"><span id="welcome-name"></span>ë‹˜, ì˜¤ëŠ˜ë„ í™”ì´íŒ…í•˜ì„¸ìš”!</p>
        
        <div class="menu-grid">
            <a href="exam.html" class="menu-item">
                <h3>ğŸ“ ì¡¸ì—… ì‹œí—˜</h3>
                <p>ì…ë¬¸ë°˜ ìµœì¢… ê´€ë¬¸, ë‹¨ë¬¸ ë° ì•½ì–´ í…ŒìŠ¤íŠ¸</p>
            </a>
            <a href="speed.html" class="menu-item">
                <h3>â±ï¸ ììˆ˜ ì¸¡ì •</h3>
                <p>ì‹¤ì‹œê°„ ì—°ì„¤ë¬¸ ììˆ˜ ë° ì†ë„ ì¸¡ì •</p>
            </a>
            <a href="abbr.html" class="menu-item">
                <h3>ğŸ’Š ì•½ì–´ ì—°ìŠµ</h3>
                <p>ëœë¤í•˜ê²Œ íŠ€ì–´ë‚˜ì˜¤ëŠ” ì•½ì–´ ë§ˆìŠ¤í„°</p>
            </a>
            <button onclick="handleLogout()" style="background:#666; margin-top: 20px; max-width: 200px;">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </div>

    <script>
        // ì‚¬ìš©ìì˜ ì‹¤ì œ GAS ë°°í¬ URLë¡œ êµì²´í•˜ì„¸ìš”
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwq78wBPliyu7Opm10o9hiEi3rWqeaJpZHTDPitK9Y8UJQDcdkd7stp90sE2I9wYfk/exec";

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ ë° ë™ì‹œì ‘ì† í™•ì¸
        window.onload = function() {
            if (localStorage.getItem('shorthand_user')) {
                showDashboard();
                checkAuth(); // ë™ì‹œì ‘ì† ì—¬ë¶€ ì¦‰ì‹œ í™•ì¸
            }
        };

        // ë¡œê·¸ì¸ ì²˜ë¦¬
        async function handleLogin() {
            const name = document.getElementById('user-name').value;
            const pw = document.getElementById('user-pw').value;

            if(!name || !pw) return alert("ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");

            try {
                const res = await fetch(GAS_URL, {
                    method: "POST",
                    body: JSON.stringify({ action: "login", name: name, pw: pw })
                });
                const data = await res.json();

                if (data.result === "success") {
                    localStorage.setItem('shorthand_user', data.name);
                    localStorage.setItem('shorthand_token', data.token); // ì„œë²„ì—ì„œ ë°›ì€ ìƒˆ í† í° ì €ì¥
                    showDashboard();
                } else {
                    alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤.");
                }
            } catch (e) {
                alert("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }
        }

        // ë™ì‹œì ‘ì† ì²´í¬ (í•µì‹¬ ë¡œì§)
        async function checkAuth() {
            const name = localStorage.getItem('shorthand_user');
            const token = localStorage.getItem('shorthand_token');

            if (!name || !token) return;

            try {
                const res = await fetch(GAS_URL, {
                    method: "POST",
                    body: JSON.stringify({ action: "checkToken", name: name, token: token })
                });
                const data = await res.json();

                if (data.result === "invalid") {
                    alert("ğŸš¨ ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸ì´ ê°ì§€ë˜ì–´ ì ‘ì†ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
                    handleLogout();
                }
            } catch (e) {
                console.log("ì¸ì¦ ì²´í¬ ì‹¤íŒ¨");
            }
        }

        function showDashboard() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('dashboard').style.display = 'flex';
            document.getElementById('welcome-name').innerText = localStorage.getItem('shorthand_user');
        }

        function handleLogout() {
            localStorage.clear();
            location.reload();
        }

        // 1ë¶„ë§ˆë‹¤ ë™ì‹œì ‘ì† ìƒíƒœ ê°ì‹œ
        setInterval(checkAuth, 60000);
    </script>
</body>
</html>
